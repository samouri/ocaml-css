<html>
  <head>
    <link rel="stylesheet" href="./styles.css">
    <link rel="stylesheet" href="lib/codemirror.css">
    <script src="./index.js"></script>
  </head>
  <body>
    <div class="top-background-wrapper"><div class="top-background"></div></div>
    <section class="header">
      <a href="/docs"> Docs </a>
      <a href="https://github.com/samouri/ocaml-css"> GitHub </a>
    </section>
    <h1 class="page-title"> css-parse </h1>
    <h2 class="page-subtitle"> Parse and print your css in OCaml and JavaScript </h1>
    <div class="explorer-area">
      <textarea class="css-input">
      <textarea class="css-ast"></textarea>
    </textarea>
    </div>
  </body>
  <script>
    const inputStartValue = `h1 {
  font-size: 12px;
  font-family: OCaml-Times;
}

.floated {
  float: right;
}`;
    const cssInput = document.getElementsByClassName("css-input")[0];
    const cssAst = document.getElementsByClassName("css-ast")[0];
    cssInput.value = inputStartValue;
    cssAst.value = window.astPrint(window.parse(inputStartValue));

    const cssCodeMirror = window.CodeMirror.fromTextArea(cssInput, {
      mode: 'css',
      lineNumbers: true,
    });

    const astCodeMirror = window.CodeMirror.fromTextArea(cssAst, {
      mode: { name: 'javascript', json: true },
      lineNumbers: true,
    });

    cssCodeMirror.on('change', e => {
      const val = cssCodeMirror.getValue();
      try {
        astCodeMirror.setValue( window.astPrint(window.parse(val)));
      } catch( e ) {
        console.log(e);
        astCodeMirror.setValue("ERROR");
      }
      astCodeMirror.refresh();
    }); 
  </script>
</html>
